<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Обработка взаимодействия | Android курс в Технополисе 2019</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Обработка взаимодействия" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/02_views_layouts_recycler/024_interaction/" />
<meta property="og:url" content="http://localhost:4000/02_views_layouts_recycler/024_interaction/" />
<meta property="og:site_name" content="Android курс в Технополисе 2019" />
<script type="application/ld+json">
{"url":"http://localhost:4000/02_views_layouts_recycler/024_interaction/","headline":"Обработка взаимодействия","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=d3418c91688b3f949df607a428f4549250f0b594">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">Android курс в Технополисе 2019</a></h1>
      

      <p>В этом уроке мы познакомимся с основными событиями ввода в Android.</p>

<h2 id="обзор">Обзор</h2>

<p>В системе Android предусмотрено несколько способов перехвата событий взаимодействия пользователя с вашим приложением. Например, когда пользователь касается отображаемого объекта (кнопки), вызывается метод <code class="highlighter-rouge">onTouchEvent()</code> этого объекта.</p>

<p>Основные методы взаимодействия с <code class="highlighter-rouge">View</code>:</p>

<ul>
  <li><code class="highlighter-rouge">onClick()</code> из <code class="highlighter-rouge">View.OnClickListener</code>. Этот метод вызывается, когда пользователь касается элемента;</li>
  <li><code class="highlighter-rouge">onLongClick()</code> из <code class="highlighter-rouge">View.OnLongClickListener</code>. Этот метод вызывается, когда пользователь касается элемента и удерживает его;</li>
  <li><code class="highlighter-rouge">onFocusChange()</code> из  <code class="highlighter-rouge">View.OnFocusChangeListener</code>. Этот метод вызывается, когда пользователь делает активным или не активным текущий элемент;</li>
  <li><code class="highlighter-rouge">onKey()</code> из <code class="highlighter-rouge">View.OnKeyListener</code>. Этот метод вызывается, когда пользователь переносит фокус на элемент и нажимает или отпускает клавишу на устройстве;</li>
  <li><code class="highlighter-rouge">onTouch()</code> из <code class="highlighter-rouge">View.OnTouchListener</code>. Этот метод вызывается, когда пользователь выполняет действие, считающееся событием касания, например, нажимает, отпускает или выполняет любой жест на экране (в пределах границ элемента).</li>
  <li><code class="highlighter-rouge">onCreateContextMenu()</code> из <code class="highlighter-rouge">View.OnCreateContextMenuListener</code>. Этот метод вызывается, когда создается контекстное меню.</li>
</ul>

<p>Чтобы определить один из этих методов и обрабатывать события, необходимо реализовать интерфейс в вашем проекте или определите его как анонимный класс.</p>

<p>Обратимся к документации. Обратите внимание, что вызов <code class="highlighter-rouge">onClick()</code> не содержит возвращаемого значения, но некоторые методы должны возвращать значение. Нужно возвращать значение или нет, зависит от события. Например:
<code class="highlighter-rouge">onLongClick()</code> — этот метод возвращает значение, указывающее, что вы обработали это событие: <code class="highlighter-rouge">true</code> - вы обработали событие и его следует остановить, <code class="highlighter-rouge">false</code> -  если вы не обработали его и/или событие должно продолжаться.</p>

<h2 id="ontouch">onTouch</h2>

<p>С простейшим onClick мы разобрались в предыдущем уроке. Давайте теперь посмотрим, что такое onTouch и с какими событиями он может работать. Для этого создадим новое <code class="highlighter-rouge">View</code> и установим ему <code class="highlighter-rouge">onTouchListener</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">View</span> <span class="n">touchView</span> <span class="o">=</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">activity_main__touch</span><span class="o">);</span>
<span class="n">touchView</span><span class="o">.</span><span class="na">setOnTouchListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnTouchListener</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onTouch</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">,</span> <span class="n">MotionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="n">event</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div></div>

<p>Запустив приложение и коснувшись экрана, мы увидим одну строку:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2019-02-21 16:20:47.356 19804-19804/com.example E/polis-mail-ru: MotionEvent { action=ACTION_DOWN, actionButton=0, id[0]=0, x[0]=543.0, y[0]=1072.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=227328288, downTime=227328288, deviceId=7, source=0x1002 }
</code></pre></div></div>

<p>В логах есть упоминание только о событии <code class="highlighter-rouge">ACTION_DOWN</code>, но если обратиться к документации, событий гораздо больше. Почему другие события не попали в логи? Дело в том, что мы вернули <code class="highlighter-rouge">false</code> в методе <code class="highlighter-rouge">onTouch</code>, следовательно, мы сами сообщили о том, что завершили обработку событий. Давайте теперь попробуем вернуть значение <code class="highlighter-rouge">true</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2019-02-21 16:35:53.260 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_DOWN, actionButton=0, id[0]=0, x[0]=605.0, y[0]=549.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=228234191, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.429 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=605.0, y[0]=552.092, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=2, eventTime=228234358, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.445 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=605.0, y[0]=556.1218, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=2, eventTime=228234375, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.462 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=606.0, y[0]=559.3099, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=2, eventTime=228234391, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.479 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=606.0, y[0]=561.2624, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=2, eventTime=228234408, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.513 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=606.0, y[0]=562.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=228234431, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.529 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=606.0, y[0]=563.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=228234456, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.554 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_MOVE, actionButton=0, id[0]=0, x[0]=607.0, y[0]=564.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=228234482, downTime=228234191, deviceId=7, source=0x1002 }
2019-02-21 16:35:53.556 22701-22701/com.example E/polis-mail-ru: MotionEvent { action=ACTION_UP, actionButton=0, id[0]=0, x[0]=607.0, y[0]=564.0, toolType[0]=TOOL_TYPE_FINGER, buttonState=0, metaState=0, flags=0x0, edgeFlags=0x0, pointerCount=1, historySize=0, eventTime=228234489, downTime=228234191, deviceId=7, source=0x1002 }
</code></pre></div></div>

<p>Теперь в нашем логе появились новые события: <code class="highlighter-rouge">ACTION_MOVE</code> и <code class="highlighter-rouge">ACTION_UP</code>.</p>

<h2 id="что-почитать">Что почитать</h2>

<ul>
  <li>https://developer.android.com/guide/topics/ui/ui-events</li>
  <li>https://developer.android.com/training/gestures/viewgroup</li>
  <li>https://guides.codepath.com/android/gestures-and-touch-events</li>
</ul>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
